\documentclass{beamer}
\usetheme{Madrid}
\usepackage{pgfplots}
\pgfplotsset{compat=1.15}
\usepackage{mathrsfs}
\usetikzlibrary{arrows}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage{nicematrix}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage{fancyvrb}
\usepackage{comment}
\usepackage{array}
\usepackage{pgfcore}
\usepackage{listings}
\usepackage{color}
\definecolor{munsell}{rgb}{0.0, 0.5, 0.69}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\definecolor{minas}{RGB}{0.244, 0.172, 0.36}
\definecolor{PUJ}{RGB}{44, 86, 151}
\definecolor{PUJ2}{RGB}{43, 93, 156}
\definecolor{PUJ3}{RGB}{20, 52, 107}
\definecolor{cyandk}{rgb}{0.0, 0.72, 0.92}
\setbeamerfont{frametitle}{size=\LARGE ,series=\bfseries}
\setbeamercolor{frametitle}{fg=PUJ2, bg=white} %% title of the beamer
\setbeamercolor{titlelike}
{parent=structure,bg=PUJ2}
\setbeamercolor{title}{fg=white, bg=PUJ3} 
%\setbeamercolor{navigation symbols}{fg=white, bg=white}
\setbeamercolor*{palette primary}{use=structure,fg=black,bg=yellow}
\setbeamercolor*{palette secondary}{use=structure,fg=white,bg=PUJ3}
\setbeamercolor*{palette tertiary}{use=structure,fg=white,bg=PUJ3}

\setbeamercolor{block title}{bg=PUJ3,fg=white}


%% code information
\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  classoffset=1,
  morekeywords={True,False}, keywordstyle=\color{munsell}, 
  classoffset=0, 
  keywordstyle=\color{blue},  
  commentstyle=\color{dkgreen},
  stringstyle=\color{PUJ3},
  numberstyle=\tiny\color{gray},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=4,
}

%% You can change default language in the middle of document with \lstset{language=Java}.


%% PUT or Remove the logo in a slide.


%% Information topic

\institute{Javeriana}
\date{2020}

\title[Pontificia Universidad Javeriana] %optional
{Decision tree }
\subtitle{ Using python.}

\author[Iván Andrés Trujillo] 
{
Iván Andrés Trujilllo Abella}

\institute[] 
{
  Facultad de Ingenieria\\
  Pontificia Universidad Javeriana
  \and
  
\textbf{ trujilloiv@javeriana.edu.co }
}

\date[MINTA] % (optional)

\newif\ifplacelogo % create a new conditional
\placelogotrue % set it to true
%\logo{\ifplacelogo\color{red}\rule{.5cm}{.5cm}\fi}
\logo{\ifplacelogo \includegraphics[height= 2.0cm]{pujshield.eps}\fi}



\begin{document}



\frame{\titlepage}



\begin{frame}{Supervised Learning Machine}
In this case the algorithm will learn about the real label.
\end{frame}



\begin{frame}[fragile]{Decision tree}
What is a np-hard problem?


Gini impurity.


\end{frame}







\begin{frame}

\end{frame}





\begin{frame}{Insights}
The worse situation is when i a leaf each class have the same probability. due of there are not domination.
\end{frame}





\begin{frame}[fragile]{insights}
We need choose the better variable of the data set as the root node.
\end{frame}

\begin{frame}[fragile]{Which is the better variable}


\end{frame}


\begin{frame}[fragile]{Insights}
The idea is reduce the entropy in all tree, then if there are $k$ classes we have 
\begin{equation}
H(T) = \sum_{i=1}^{k} p_{i}H(i)
\end{equation}

\end{frame}



\begin{frame}
train and test data.

information gain:


why entropy is convex?
it is a theorem?


\end{frame}



\begin{frame}{insights about question}
For instance when one person need guess a object to another person, need ask more informative question eliminating a large of options for instance it is animal?, is more informative that ask for color.

\end{frame}


\begin{comment}
bagging: despido
boosting:impulsando
bagged:ensacado
pull out= extraer, arrancar.
lifting: levantamiento
compression algorithms:
charm:ecanto, atractivo
bins: cotenedores
booked: reservado.
downtown:centro de la ciudad.
customers: cliente.
annoyed:molesto  anoied..
outlook:panorama, perspectiva
overcast: nublado, cubierto.
mild:templado, leve, suave.
come up:sube, surgir.
player turnout: participación de la jugadora
start rolling: empezar a rodar
fully:completamente.
way out:salida.
greedy search:
stepping down: bajar
bulge:bulto, sobresalir.
lymph nodes: ganglios linfaticos.
overfeeding: sobrealimentación
churn:batir
holdout set: conjunto de reserva.
fur:piel, pelaje.
overly:demasiado.

\end{comment}


\begin{frame}{overfitting}






\end{frame}


\begin{frame}
DT is very interpretable. 
\end{frame}



\begin{frame}{bagging}


\end{frame}

\begin{frame}{representation}
\definecolor{qqwuqq}{rgb}{0,0.39215686274509803,0}
\definecolor{qqqqcc}{rgb}{0,0,0.8}
\definecolor{qqzzqq}{rgb}{0,0.6,0}
\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=1cm,y=1cm, scale=0.6]
\clip(2.96224130675376,-22.793028999008355) rectangle (24.80483491897773,5.168030818063442);
\draw [line width=2pt] (12.98,3) circle (1.2cm);
\draw [->,line width=2pt] (12.582809869206194,1.8084296076185846) -- (10.52,0.26);
\draw [->,line width=2pt] (13.237755072788042,1.7707065759339502) -- (15.44,0.14);
\draw [line width=2pt] (10.06,-0.8) circle (1.2cm);
\draw [line width=2pt] (12.98,3) circle (1.256025477448607cm);
\draw [line width=2pt] (16.08,-0.88) circle (1.2cm);
\draw [->,line width=2pt] (9.115938985022686,-1.6284617070209113) -- (6.7,-3.6);
\draw [line width=2pt,color=qqzzqq] (6.18,-4.66) circle (1.2560254774486062cm);
\draw [->,line width=2pt] (9.115938985022686,-1.6284617070209113) -- (9.64,-3.96);
\draw [line width=2pt,color=qqqqcc] (9.708092431542712,-5.194605045638192) circle (1.2cm);
\draw [->,line width=2pt] (16.257628826489395,-2.123401785425772) -- (16.1,-4.2);
\draw [->,line width=2pt] (16.257628826489395,-2.123401785425772) -- (19.26,-3.58);
\draw [line width=2pt,color=qqqqcc] (19.98,-4.62) circle (1.2cm);
\draw [line width=2pt,color=qqwuqq] (15.741348738590451,-5.338651261409549) circle (1.2cm);
\draw (12.497592525493255,3.4326871834541937) node[anchor=north west] {$\mathit{\mathbf{root}}$};
\begin{scriptsize}
\draw[color=black] (11.740563423146938,0.8762581378385566) node {};
\draw[color=black] (14.174703152229712,0.7947319268166455) node {};
\draw[color=black] (7.769072286222412,-2.932180577042142) node {};
\draw[color=black] (9.783934358621073,-3.165112608533316) node {};
\draw[color=black] (16.282738037224842,-3.2582854211297856) node {};
\draw[color=black] (18.716877766307615,-2.955473780191259) node {};
\end{scriptsize}
\end{tikzpicture}
\end{frame}



\begin{frame}{Nodes, leaves}
Each node is a variable and the links are the possible values that could be take the variable.


The green and blue circles are the leaves of the tree, and inside of them are the class to predict

\end{frame}


\begin{frame}{Nodes,Links}
\begin{figure}
\definecolor{xdxdff}{rgb}{0.49019607843137253,0.49019607843137253,1}
\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,scale=0.9]
\clip(0,5) rectangle (13,12);
\draw [line width=2pt] (6.038606830933502,10.256222395728951) circle (1.2731064370271643cm);
\draw [->,line width=2pt] (5.999499575278403,8.98371674837208) -- (4,8);
\draw [->,line width=2pt] (5.999499575278403,8.98371674837208) -- (8,8);
\draw [line width=2pt] (3.8380174677238967,6.665787118913279) circle (1.2731064370271636cm);
\draw (5.538024737783674,10.501822999027546) node[anchor=north west] {$\mathbf{Variable}$};
\draw (4.467430630675179,9.139248680889464) node[anchor=north west] {$\mathbf{Yes}$};
\draw (7.212044614353319,9.119783333487492) node[anchor=north west] {$\mathbf{No}$};
\draw (3.2119157232479454,6.949397098167547) node[anchor=north west] {$\mathbf{Variable 2}$};
\begin{scriptsize}
\draw [fill=xdxdff] (5.999499575278403,8.98371674837208) circle (2.5pt);
\end{scriptsize}
\end{tikzpicture}
\end{figure}

The node \textbf{variable} have two possible values \textbf{Yes} and \textbf{No}.
\end{frame}


\begin{frame}[fragile]{Pseudo code}
\begin{verbatim}
Choose the better variable
split the data according the attributes
of the better variable, 
for each instance apply the same process recursively.
\end{verbatim}
\end{frame}




\begin{frame}
% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[]
\centering
\resizebox{\columnwidth}{!}{%
\begin{tabular}{cccc}
\textbf{Sector} & \textbf{Income} & \textbf{Size} & \textbf{Bankruptcy} \\
Financial       & High            & Medium        & No                  \\
Financial       & High            & Medium        & No                  \\
Financial       & Low             & Small         & Yes                 \\
Agricultural    & Low             & Small         & No                  \\
Agricultural    & Low             & Medium        & No                  \\
Agricultural    & High            & Small         & Yes                 \\
Agricultural    & High            & Small         & Yes                
\end{tabular}%
}
\caption{Complete data set}
\label{tab:my-table}
\end{table}
\end{frame}


\begin{frame}{Split data by Sector}
\begin{columns} 
    \begin{column}{.5\textwidth}
\begin{table}[]
\centering
\resizebox{\columnwidth}{!}{%
\begin{tabular}{cccc}
\textbf{sector} & \textbf{income} & \textbf{size} & \textbf{bankruptcy} \\
Financial       & High            & Medium        & No                  \\
Financial       & High            & Medium        & No                  \\
Financial       & Low             & Small         & Yes                
\end{tabular}%
}
\caption{Financial}
\label{tab:my-table}
\end{table}


    \end{column}
% Column 2    
    \begin{column}{.5\textwidth}
% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[]
\centering
\resizebox{\columnwidth}{!}{%
\begin{tabular}{cccc}
\textbf{sector} & \textbf{income} & \textbf{size} & \textbf{bankruptcy} \\
Agricultural    & Low             & Small         & No                  \\
Agricultural    & Low             & Medium        & No                  \\
Agricultural    & High            & Small         & Yes                 \\
Agricultural    & High            & Small         & Yes                
\end{tabular}%
}
\caption{Agricultural}
\label{tab:my-table}
\end{table}
\end{column} 
\end{columns}
\end{frame}



\begin{frame}{Process}
Until now we suppose that the better variable of the data set is \textbf{sector} after, by each instance suppose that we find the better variable  assuming for instance that for $financial$ is $income$ and for $agriculture$ is $size$.
\end{frame}


\begin{frame}{Stopping criteria}
% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[]
\centering
\resizebox{8cm}{!}{%
\begin{tabular}{ccc}
\textbf{income} & \textbf{size} & \textbf{bankruptcy} \\
Low             & Small         & Yes                 \\
High            & Small         & Yes                 \\
High            & Small         & Yes                
\end{tabular}%
}
\caption{}
\label{tab:my-table}
\end{table}
The algorithm will stop when the label is the same for all rows, then return a leaf with the attribute of class.
\end{frame}



\begin{frame}{Stopping criteria}
% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[]
\centering
\resizebox{8cm}{!}{%
\begin{tabular}{ccc}
\textbf{Income} & \textbf{Size} & \textbf{Bankruptcy} \\
High            & Medium        & Yes                 \\
High            & Medium        & No                  \\
High            & Medium        & Yes                
\end{tabular}%
}
\caption{}
\label{tab:my-table}
\end{table}
The algorithm will stop when attributes are the same for all variables, then return a leaf withe the most common.
\end{frame}


\begin{frame}{How select the better variable?}{Entropy}
The better variable will be those that is able to discriminate among the classes, for instance to select a variable and split all belong to the same class.

This lead to homogeneity concept:
for instance we select \textbf{Sector} and split \textbf{financial} and \textbf{agricultural} and of $N$ patterns

\[
\begin{bmatrix}
Financial &   Yes  = \frac{N}{2}-4 \\
		  &    No  = 4 \\
Agricultural & Yes = 4\\
             & No  = \frac{N}{2}-4
\end{bmatrix}
\]
this mean to split the data in $Financial$ there are $\frac{N}{2}-4$ rows with yes and $4$ with No.

\end{frame}




\begin{frame}{Bad quality}
A variable with bad quality not let us discriminate and therefore the proportion could be equally in each class.

\end{frame}


\begin{frame}{Entropy}
\begin{columns} 
    \begin{column}{.2\textwidth}
\begin{table}[]
\centering
\resizebox{3cm}{2cm}{%
\begin{tabular}{c}
\textbf{Bankruptcy} \\
Yes                 \\
No                  \\
Yes                 \\
Yes                 \\
No					 \\
No
\end{tabular}%
}
\label{tab:my-table}
\end{table}
    \end{column}

\begin{column}{.7\textwidth}
$
Entropy(Bankruptcy) = -\frac{3}{6}log_{2}\frac{3}{6} - \frac{3}{6}log_{2}\frac{3}{6}$
\\
Note here that is the probability of occur yes $=\frac{3}{6}$.
Generally $Entropy(var) = - \sum_{i}^{classes} P_{i}log_{2}P_{i}$.

\end{column}
\end{columns}

\end{frame}


\begin{frame}{Gain of information}

\end{frame}






\begin{frame}[fragile]{if-else}
Root is the first node, the circle with colors are also known as leaves. Literally, each node is a question, \emph{the x value is greater or not than k?}




\end{frame}



\begin{frame}{Predict a new observation}
To predict a new pattern, the tree only follow the path relative to the attributes that have the new data.

\end{frame}




\begin{frame}[fragile]{Python}
\begin{lstlisting}
from sklearn import 

\end{lstlisting}
\end{frame}



\end{document}